<?php

/**
 * Test class for HH_Validate_SubdomainUnique.
 * Generated by PHPUnit on 2010-09-18 at 23:22:29.
 */
class HH_Validate_SubdomainUniqueTest extends PHPUnit_Framework_TestCase
{
    /**
     *
     * @var HH_Domain_Farm
     */
    private $farm;
    private $subdomain;

    /**
     * Sets up the fixture, for example, opens a network connection.
     * This method is called before a test is executed.
     */
    protected function setUp()
    {
        $this->subdomain = rand(1,2000);

        $data = array(
            'id' => 999999,
            'status' => HH_Domain_Farm::STATUS_ACTIVE,
            'version' => HH_Domain_Farm::getLatestVersion(),
            'name' => 'Foo Farm',
            'address' => '123 Foo Street',
            'address2' => '',
            'city' => 'Port Williams',
            'state' => 'NS',
            'zipCode' => 'B4N5B8',
            'country' => 'CA',
            'timeZone' => 'America/Halifax',
            'telephone' => '90236522213',
            'fax' => '9023652213',
            'email' => 'foo@farm.com',
            'addedDatetime' => Zend_Date::now()->setTimezone('UTC'),
            'updatedDatetime' => Zend_Date::now()->setTimezone('UTC'),
            'primaryFarmerId' => null,
            'subdomain' => $this->subdomain
        );

        $this->farm = new HH_Domain_Farm($data['id'], $data);
        $this->farm->delete();
        $this->farm = new HH_Domain_Farm($data['id'], $data);
        $this->farm->insert($data);
    }

    /**
     * Tears down the fixture, for example, closes a network connection.
     * This method is called after a test is executed.
     */
    protected function tearDown()
    {
        $this->farm->delete();
    }

    public function testIsValid()
    {
        
        $validator = new HH_Validate_SubdomainUnique();
        $this->assertFalse($validator->isValid($this->subdomain));

        $validator = new HH_Validate_SubdomainUnique($this->farm);
        $this->assertTrue($validator->isValid($this->subdomain));
        
    }

}

?>
